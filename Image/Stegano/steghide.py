#!/usr/bin/env python
#-*- coding:Latin-1 -*-

# import image
from PIL import Image

im = Image.open("image.png")
#On récupère les dimensions de l'image
w,h = im.size
#On eclate l'image en trois (rouge, vert, bleu)
r,g,b = im.split()
#On transforme les images en liste
r = list(r.getdata())

#Le message à coder
c="Hello World"
#On note la longueur de la chaine et on la transforme en binaire
u=len(c)
v=bin(len(c)) [2:].rjust(8,"0")
#On transforme la chaine en binaire
ascii = [bin(ord(x)) [2:].rjust(8,"0") for x in c]
#Transformation de la liste en chaine
a=''.join(ascii)
#On code la longueur de la liste dans les 8 premiers pixels rouges
for j in range(8):
    r[j]=2*int (r[j]//2)+int(v[j])

#On code la chaine dans les pixels suivants
for i in range(8*u):
    r[i+8]=2*int (r[i+8]//2)+int(a[i])
#On recrée l'image en rouge
nr = Image.new("L", (w,h))
nr.putdata(r)
#Fusion des trois images
imgnew = Image.merge("RGB", (nr,g,b))
imgnew.save("image2.png")